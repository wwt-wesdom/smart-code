import{_ as n,c as p,a as h,b as l,g as u,s as f,k as _,o,l as y}from"./index-1a5453e3.js";const I={name:"uploadImg",data(){return{uploadId:p.getUuid(),imgSrc:this.modelValue,copyImgSrc:this.value,imgWidth:0,imgHeight:0}},props:{width:{require:!0,type:String,default:"104px"},height:{require:!0,type:String,default:"104px"},modelValue:{require:!1,type:String,default:""},type:{require:!1,type:String,default:"single"},fill:{require:!1,type:String,default:"cover"},showMask:{require:!1,type:Boolean,default:!1}},computed:{getImgStyle(){let t={};return this.imgWidth?this.imgWidth>=this.imgHeight?t={width:this.width,height:"auto"}:t={width:"auto",height:this.height}:this.fill==="cover"?t={width:this.width,height:this.height}:this.fill==="fillWidth"?t={width:this.width,height:"auto"}:t={height:this.height,width:"auto"},t}},methods:{getRealWidthHeight(){if(!this.value)return;let t=this.value,e=new Image;e.src=t,e.onload=()=>{this.imgWidth=e.width,this.imgHeight=e.height}},uploadImgTest(t){const e=this,i=t.target.files[0];if(!i)return;i.type,i.size,i.name,i.lastModifiedDate,(i.size/1024).toFixed(2);const r=new FileReader;r.readAsDataURL(i),r.onload=d=>{const s=d.target.result,a=new Image;let g=0,m=0;a.onload=()=>{if(g=a.width,m=a.height,e.imgWidth=g,e.imgHeight=m,e.type==="single")e.imgSrc=s,e.$emit("change",s),e.$emit("update:modelValue",this.imgSrc);else{let c={result:s,width:g,height:m};e.$emit("change",c)}e.$refs.uploadImg.value=""},a.src=s}},restore(){this.imgSrc=this.copyImgSrc,this.imgWidth=0,this.imgHeight=0,this.$emit("change",this.imgSrc),this.$emit("update:modelValue",this.imgSrc)}},mounted(){this.getRealWidthHeight()},watch:{value(t,e){this.imgSrc=t}}},w={style:{display:"inline-block",background:"#F5F5F5",border:"1px solid #ddd"}},S=["id"],v=["for"],k=["src"],b={key:1},W=l("div",{class:"center"},[l("i",{class:"tzt-icon-plus c999 fs-30"}),l("div",{class:"c999"},"上传图片"),y("uploadImg ")],-1),x={key:0,class:"upload-img-mask-father"},V={class:"upload-img-mask"},H=["for"];function q(t,e,i,r,d,s){return o(),h("div",w,[l("div",{class:"flex-center-center pos-relative upload-img-label",style:u({height:i.height,width:i.width})},[l("input",{style:{display:"none"},type:"file",onInput:e[0]||(e[0]=(...a)=>s.uploadImgTest&&s.uploadImgTest(...a)),id:"uploadImg_"+d.uploadId,name:"image",ref:"uploadImg",accept:"image/*"},null,40,S),l("label",{for:"uploadImg_"+d.uploadId},[d.imgSrc?(o(),h("img",{key:0,class:"block",style:u(s.getImgStyle),src:d.imgSrc,alt:""},null,12,k)):(o(),h("div",b,[f(t.$slots,"default",{},()=>[W])]))],8,v),i.showMask?(o(),h("div",x,[l("div",V,[l("label",{class:"pd5 cursor-point",for:"uploadImg_"+d.uploadId},"修改",8,H),l("span",{class:"pd5 cursor-point",onClick:e[1]||(e[1]=(...a)=>s.restore&&s.restore(...a))},"还原")])])):_("",!0)],4)])}const z=n(I,[["render",q]]);export{z as default};
